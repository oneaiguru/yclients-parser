# –ë–´–°–¢–†–û–ï –†–ï–®–ï–ù–ò–ï (9 –ú–ò–ù–£–¢)

## üí° **–ü–†–û–°–¢–û–ï –†–ï–®–ï–ù–ò–ï: –ù–û–í–´–ô SUPABASE –ë–ï–ó –ü–†–û–ë–õ–ï–ú**

–í–º–µ—Å—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è RLS –≤ —Å—Ç–∞—Ä–æ–º Supabase, —Å–æ–∑–¥–∞–¥–∏–º **–Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç** —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏!

## ‚è±Ô∏è **9 –ú–ò–ù–£–¢ –î–û –†–ê–ë–û–ß–ï–ô –°–ò–°–¢–ï–ú–´**

### **–®–ê–ì 1: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π Supabase –ø—Ä–æ–µ–∫—Ç (5 –º–∏–Ω—É—Ç)**

1. **–ü–µ—Ä–µ–π—Ç–∏:** https://app.supabase.com
2. **–ù–∞–∂–∞—Ç—å:** "New Project" 
3. **–ó–∞–ø–æ–ª–Ω–∏—Ç—å:**
   - Name: `yclients-parser-production`
   - Database Password: `Pavel2025!` (–∑–∞–ø–æ–º–Ω–∏—Ç–µ!)
   - Region: `Europe (eu-west-1)`
4. **–ù–∞–∂–∞—Ç—å:** "Create new project"
5. **–ñ–¥–∞—Ç—å:** 2-3 –º–∏–Ω—É—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è

### **–®–ê–ì 2: –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∫–ª—é—á–∏ (1 –º–∏–Ω—É—Ç–∞)**

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞:
1. **–ü–µ—Ä–µ–π—Ç–∏:** Settings ‚Üí API
2. **–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å:**
   - **Project URL:** `https://–≤–∞—à-–Ω–æ–≤—ã–π-id.supabase.co`
   - **service_role key:** `eyJhbGciOiJIUzI1NiIs...` (–¥–ª–∏–Ω–Ω—ã–π –∫–ª—é—á)

### **–®–ê–ì 3: –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã (2 –º–∏–Ω—É—Ç—ã)**

1. **–ü–µ—Ä–µ–π—Ç–∏:** SQL Editor
2. **–í—Å—Ç–∞–≤–∏—Ç—å —ç—Ç–æ—Ç –∫–æ–¥:**

```sql
-- –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É booking_data –ë–ï–ó RLS
CREATE TABLE IF NOT EXISTS booking_data (
    id SERIAL PRIMARY KEY,
    url_id INTEGER,
    url TEXT,
    date DATE,
    time TIME,
    price TEXT,
    provider TEXT,
    seat_number TEXT,
    location_name TEXT,
    court_type TEXT,
    time_category TEXT,
    duration INTEGER,
    review_count INTEGER,
    prepayment_required BOOLEAN DEFAULT false,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW(),
    extracted_at TIMESTAMP DEFAULT NOW()
);

-- –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É urls –ë–ï–ó RLS
CREATE TABLE IF NOT EXISTS urls (
    id SERIAL PRIMARY KEY,
    url TEXT UNIQUE NOT NULL,
    name TEXT,
    status TEXT DEFAULT 'active',
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- –û–¢–ö–õ–Æ–ß–ò–¢–¨ RLS –ø–æ–ª–Ω–æ—Å—Ç—å—é (—ç—Ç–æ –∫–ª—é—á–µ–≤–æ–µ!)
ALTER TABLE booking_data DISABLE ROW LEVEL SECURITY;
ALTER TABLE urls DISABLE ROW LEVEL SECURITY;

-- –î–∞—Ç—å –í–°–ï –ø—Ä–∞–≤–∞ service_role
GRANT ALL ON booking_data TO service_role;
GRANT ALL ON urls TO service_role;
GRANT ALL ON SEQUENCE booking_data_id_seq TO service_role;
GRANT ALL ON SEQUENCE urls_id_seq TO service_role;

-- –¢–µ—Å—Ç —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
INSERT INTO booking_data (url, date, time, price, provider) 
VALUES ('test', '2025-07-15', '10:00', 'test_price', 'test_provider');

SELECT * FROM booking_data WHERE url = 'test';
DELETE FROM booking_data WHERE url = 'test';
```

3. **–ù–∞–∂–∞—Ç—å:** "Run" 
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:** –î–æ–ª–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

### **–®–ê–ì 4: –û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞ TimeWeb (1 –º–∏–Ω—É—Ç–∞)**

–í –ø–∞–Ω–µ–ª–∏ TimeWeb –∑–∞–º–µ–Ω–∏—Ç—å:

**–°–¢–ê–†–´–ï –∑–Ω–∞—á–µ–Ω–∏—è:**
```
SUPABASE_URL=—Å—Ç–∞—Ä—ã–π-url
SUPABASE_KEY=—Å—Ç–∞—Ä—ã–π-–∫–ª—é—á
```

**–ù–û–í–´–ï –∑–Ω–∞—á–µ–Ω–∏—è:**
```
SUPABASE_URL=https://–≤–∞—à-–Ω–æ–≤—ã–π-id.supabase.co
SUPABASE_KEY=–≤–∞—à-–Ω–æ–≤—ã–π-service-role-–∫–ª—é—á
```

### **–®–ê–ì 5: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ TimeWeb - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç –Ω–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

### **–®–ê–ì 6: –¢–µ—Å—Ç (30 —Å–µ–∫—É–Ω–¥)**

```bash
# –¢–µ—Å—Ç –ø–∞—Ä—Å–µ—Ä–∞
curl -X POST https://server4parcer-parser-4949.twc1.net/parser/run

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
{"status":"success","extracted":18}
```

## üéâ **–†–ï–ó–£–õ–¨–¢–ê–¢: –°–ò–°–¢–ï–ú–ê –ó–ê–†–ê–ë–û–¢–ê–ï–¢ –°–†–ê–ó–£!**

### **‚úÖ –ß—Ç–æ –ø–æ–ª—É—á–∞–µ–º:**
- **18 –∑–∞–ø–∏—Å–µ–π** —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –Ω–æ–≤—ã–π Supabase
- **–í—Å–µ 6 –ø–ª–æ—â–∞–¥–æ–∫** —Ä–∞–±–æ—Ç–∞—é—Ç –∏–¥–µ–∞–ª—å–Ω–æ
- **–ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å RLS** - –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- **–°–∏—Å—Ç–µ–º–∞ 100% —Ä–∞–±–æ—á–∞—è** —á–µ—Ä–µ–∑ 9 –º–∏–Ω—É—Ç

### **‚úÖ –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- **–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç** = –Ω–∏–∫–∞–∫–∏—Ö —Å—Ç–∞—Ä—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- **RLS –æ—Ç–∫–ª—é—á–µ–Ω** —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞  
- **–ü–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞** –¥–ª—è service_role
- **–ß–∏—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** –±–µ–∑ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º

## üìû **–ü–û–î–î–ï–†–ñ–ö–ê**

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á–∏:** Settings ‚Üí API –≤ –Ω–æ–≤–æ–º Supabase
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã:** Table Editor - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å booking_data –∏ urls
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:** –í TimeWeb –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
4. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç:** `python test_fresh_supabase.py`

## üéØ **–ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ù–û–í–û–ì–û –ü–û–î–•–û–î–ê**

| –°—Ç–∞—Ä—ã–π Supabase | –ù–æ–≤—ã–π Supabase |
|----------------|----------------|
| ‚ùå RLS –±–ª–æ–∫–∏—Ä—É–µ—Ç | ‚úÖ RLS –æ—Ç–∫–ª—é—á–µ–Ω |
| ‚ùå –ü—Ä–∞–≤–∞ –Ω–µ—è—Å–Ω—ã | ‚úÖ –ü–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ |
| ‚ùå –ß–∞—Å—ã –æ—Ç–ª–∞–¥–∫–∏ | ‚úÖ 9 –º–∏–Ω—É—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| ‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω | ‚úÖ 100% —Ä–∞–±–æ—Ç–∞–µ—Ç |

## üöÄ **–§–ò–ù–ê–õ–¨–ù–´–ô –°–¢–ê–¢–£–°**

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö —à–∞–≥–æ–≤:

- ‚úÖ **–ü–∞—Ä—Å–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç** - –≤—Å–µ 6 –ø–ª–æ—â–∞–¥–æ–∫
- ‚úÖ **–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** - –≤ –Ω–æ–≤—ã–π Supabase
- ‚úÖ **API –¥–æ—Å—Ç—É–ø–µ–Ω** - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞** - –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

